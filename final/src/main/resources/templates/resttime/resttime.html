<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
  <meta charset="UTF-8">
  <title>rotating stars</title>
  <link rel="stylesheet" href="/made/css/Healing/style.css">
  <link rel="stylesheet" href="/made/css/Healing/Healing.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css">


  <style>
    /* NOTE: The styles were added inline because Prefixfree needs access to your styles and they must be inlined if they are on local disk! */
    body {
      background: radial-gradient(200% 100% at bottom center, #f7f7b6, #e96f92, #75517d, #1b2947);
      background: radial-gradient(220% 105% at top center, #1b2947 10%, #75517d 40%, #e96f92 65%, #f7f7b6);
      background-attachment: fixed;
      overflow: hidden;
      color:white;
    }

    @keyframes rotate {
      0% {
        transform: perspective(400px) rotateZ(20deg) rotateX(-40deg) rotateY(0);
      }

      100% {
        transform: perspective(400px) rotateZ(20deg) rotateX(-40deg) rotateY(-360deg);
      }
    }

    .stars {
      transform: perspective(500px);
      transform-style: preserve-3d;
      position: absolute;
      bottom: 0;
      perspective-origin: 50% 100%;
      left: 50%;
      animation: rotate 90s infinite linear;
    }

    .star {
      width: 2px;
      height: 2px;
      background: #F7F7B6;
      position: absolute;
      top: 0;
      left: 0;
      transform-origin: 0 0 -300px;
      transform: translate3d(0, 0, -300px);
      backface-visibility: hidden;
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
</head>

<body>

  <div class="stars">

  </div>

   
  <!-- ISFP, ENFJ, INTJ 일때 보여질 카드 -->
  <th:block th:if="${info.userMbti  == 'ISFP'} or ${info.userMbti  =='ENFJ'} or ${info.userMbti  =='INTJ'}">
	  <div class="card" >
	    <div class="front"  style='background-image: url("http://localhost:8080/made/img/card.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card" >
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card1.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card" >
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card2.png");'></div>
	    <div class="back"></div>
	  </div>
  </th:block>
  
  <!-- ESFP, ENTJ, INFP 일때 보여질 카드 -->
  <th:block th:if="${info.userMbti == 'ESFP'} or ${info.userMbti  == 'ENTJ'} or ${info.userMbti  == 'INFP'}">
	  <div class="card">
	    <div class="front"  style='background-image: url("http://localhost:8080/made/img/card3.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card" >
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card4.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card">
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card5.png");'></div>
	    <div class="back"></div>
	  </div>
  </th:block>
  
  <!-- ISFJ, ESFJ, INFJ 일때 보여질 카드 -->
    <th:block th:if="${info.userMbti == 'ISFJ'} or ${info.userMbti  == 'ESFJ'} or ${info.userMbti  == 'INFJ'}">
	  <div class="card">
	    <div class="front"  style='background-image: url("http://localhost:8080/made/img/card6.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card" >
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card7.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card">
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card8.png");'></div>
	    <div class="back"></div>
	  </div>
  </th:block>
  
  <!-- ISTP, ISTJ, ESTJ, ENTP,  일때 보여질 카드 -->
    <th:block th:if="${info.userMbti == 'ISTP'} or ${info.userMbti  == 'ISTJ'} or ${info.userMbti  == 'ESTJ'} or ${info.userMbti  == 'ENTP'}">
	  <div class="card">
	    <div class="front"  style='background-image: url("http://localhost:8080/made/img/card9.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card" >
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card10.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card">
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card11.png");'></div>
	    <div class="back"></div>
	  </div>
  </th:block>
  
  <!-- INTP, ESTP, ENFP,  일때 보여질 카드 -->
    <th:block th:if="${info.userMbti == 'INTP'} or ${info.userMbti  == 'ESTP'} or ${info.userMbti  == 'ENFP'}">
	  <div class="card">
	    <div class="front"  style='background-image: url("http://localhost:8080/made/img/card12.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card" >
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card13.png");'></div>
	    <div class="back"></div>
	  </div>
	  <div class="card">
	    <div class="front" style='background-image: url("http://localhost:8080/made/img/card14.png");'></div>
	    <div class="back"></div>
	  </div>
  </th:block>
  
  <div class="header">
    <div id="header-time">

    </div>
    <div class="header-logo">
    	<a href="/register/finalLogin">
      		<img src="/made/img/main.png" alt="Logo" width="100px" height="80px">
      	</a>
    </div>

  </div>

  <div class="resttime">
    <img src="" id="restImg"alt="이미지">
    	<div id="title">
    	
    	</div>
    	<div id="text">
    
    	</div>
    <a href="/resttime/resttime">
    	<img src="/made/img/icon-back.png" id="toBack" alt="">
    </a>
  </div>


  <div class="social-menu">
	<ul>
      <li><a href="#" onclick="location.href='/mbti/html/index.html'" target="blank"></a></li>
      <li><a href="#" onclick="location.href='/mbti/html/chatting.html'" target="blank"></a></li>
      <li><a href="#" onclick="location.href='/mbti/html/Healing.html'" target="blank"></a></li>
      <li><a href="#" onclick="location.href='/mbti/html/BulletinBoard.html'" target="blank"></a></li>
    </ul>
  </div>
</body>

<script th:src="@{/scripts/jquery.min.js}"></script>
<!-- <script th:src="@{/made/js/resttime/resttime.js}"></script> -->
<script th:inline="javascript">
/*<![CDATA[*/

$(document).ready(function () {
  var stars = 800;
  var $stars = $(".stars");
  var r = 800;
  for (var i = 0; i < stars; i++) {
    var $star = $("<div/>").addClass("star");
    $stars.append($star);
  }
  $(".star").each(function () {
    var cur = $(this);
    var s = 0.2 + (Math.random() * 1);
    var curR = r + (Math.random() * 300);
    cur.css({
      transformOrigin: "0 0 " + curR + "px",
      transform: " translate3d(0,0,-" + curR + "px) rotateY(" + (Math.random() * 360) + "deg) rotateX(" + (Math.random() * -50) + "deg) scale(" + s + "," + s + ")"

    })
  })
})

function Clock (){
    var today = new Date();

    var year = today.getFullYear();
    var month = ('0' + (today.getMonth() + 1)).slice(-2);
    var day = ('0' + today.getDate()).slice(-2);
    var hours = ('0' + today.getHours()).slice(-2); 
    var minutes = ('0' + today.getMinutes()).slice(-2);
    var seconds = ('0' + today.getSeconds()).slice(-2); 

    var dateString = year + '-' + month  + '-' + day;
    var timeString = hours + ':' + minutes  + ':' + seconds;
    document.getElementById("header-time").innerHTML = dateString + " | " + timeString;
}
Clock();
setInterval(Clock, 1000);

let card = document.querySelectorAll('.card');
let toBack = document.querySelector('#toBack');
let front = document.querySelectorAll('.front');
let back = document.querySelectorAll('.back');
let resttime = document.querySelector(".resttime");
let text = document.getElementById("#text");

card.forEach(element => {
  element.addEventListener('click', click);
});

// var arrayRemove = (arr, value) => {
//   return arr.filter((ele) => {
//       console.log('ele',ele);
//       return ele != value;
//   });
// };


function delay(){
  back1.style.animationName = 'test1';
}

function click(event) {
  
  front.forEach(element => {
    element.style.transform = "rotateY(180deg)";
  });
  let elem = event.currentTarget.lastElementChild;

  // 카드가 앞면일때 뒤집기
  if (elem.style.transform == "rotateY(360deg)") {
    elem.style.transform = "rotateY(180deg)";
  } else {
    elem.style.transform = "rotateY(360deg)";
  }
    
  let restLeft =  $(resttime).width()/2  - $(card).width()/2;
  let restleft = restLeft - $(elem).offset().left;

    setTimeout(function() { 
      // $(elem).offset({}, 800);
      if (event.currentTarget == card[0]){
        $(elem).animate({
          top: "-6vh",
          left:restLeft,
          width: '60vw', 
          height: '60vh'
        },1200)
      }else{
        $(elem).animate({
          top: "-6vh",
          left:restleft,
          width: '60vw', 
          height: '60vh'
        },1200)
      }
    },800)
    
    setTimeout(function(){
      resttime.style.zIndex = '1';
      $(resttime).animate({
        opacity: 1
      },500)
    },2300)
    
    getRest();
    
    function getRest(){
		let mbti = [[ ${info.userMbti} ]]; 
		const randomNum = Math.floor(Math.random()*3+1); 
		console.log(randomNum);
		
		/* ajax로 구현 */
		$.ajax({
			url : '/resttime/resttime/', //Controller에서 인식할 주소
			type :'post', //POST 방식으로 전달
			data : {
				userMbti : mbti,
				randomNum : randomNum
				
			},
			success : function(howRest) {//성공하면 해당 함수를 실행한다.
				var splitText = howRest.split('/');
				var TitleAsHowRest = splitText[0];
				var TextAsHowRest = splitText[1];
				console.log("자른 문장 = " + TitleAsHowRest);
				console.log("본문 문장 = " + TextAsHowRest);
				/* console.log("가져온 문장 = "+a); */  // 받아온 값이 무엇인지 확인(값을 제대로 받고 있는지 확인용)
				document.getElementById("title").innerHTML = TitleAsHowRest;
				document.getElementById("text").innerHTML = TextAsHowRest;
				document.getElementById("restImg").src = "/made/img/"+mbti+randomNum+".jpg";
			},
			error: function (request, status, error) {
				alert("code: " + request.status + "message: " + request.responseText+ "error: " + error);
		    }});
		
	}
    
    
}
/*]]>*/
// 주어.행동()
// 행동(목적어)
// 행동(); 
// 안에서 누구에게 행동할건지를 정의해줘야하니까 하드코딩이 되는거고

// 부모 객체의 자식들 배열 가져옴
// 클릭한 요소는 위에서 가져옴
// 배열에서 클릭한 요소 빼고, 배열의 요소들을 dom에서 제거

// 1. 클릭했을때 클릭한 객체 가져오는 함수 연동
// 1. 클릭한 객체 가져오는 함수 구현

</script>

</html>